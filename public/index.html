<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <title>å¾®ä¿¡æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹</title>

    <!-- iOS Safari ä¸“ç”¨ä¼˜åŒ– -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’¬</text></svg>">
    <link rel="icon" type="image/png" sizes="32x32" href="./icons/ios/32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./icons/ios/16.png">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="./icons/ios/180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./icons/ios/152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./icons/ios/144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./icons/ios/120.png">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#07c160">
    <meta name="background-color" content="#ffffff">
    <meta name="apple-mobile-web-app-title" content="å¾®ä¿¡æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹">

    <meta name="description" content="åŸºäºCloudflare Workersçš„å¾®ä¿¡æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹Webåº”ç”¨">
    <meta name="keywords" content="æ–‡ä»¶ä¼ è¾“,å¾®ä¿¡,Cloudflare,Workers,PWA">
    
    <!-- æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/responsive.css">
    <link rel="stylesheet" href="css/ios-fixes.css">

    <!-- Markdownè§£æåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
</head>
<body>
    <div class="app">
        <!-- ä¸»ä½“åŒºåŸŸ -->
        <main class="app-main">
            <div class="chat-container">
                <!-- æ¶ˆæ¯åˆ—è¡¨ -->
                <div class="message-list" id="messageList">
                    <!-- æ¶ˆæ¯å†…å®¹å°†ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
                
                <!-- è¾“å…¥åŒºåŸŸ -->
                <div class="input-container">
                    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ï¼ˆæ”¯æŒå¤šæ–‡ä»¶ï¼‰ -->
                    <input type="file" id="fileInput" multiple style="display: none;">

                    <!-- ä¸Šä¼ çŠ¶æ€æ˜¾ç¤º -->
                    <div class="upload-status" id="uploadStatus" style="display: none;">
                        <div class="upload-spinner">â³</div>
                        <span>æ­£åœ¨ä¸Šä¼ ...</span>
                        <div class="upload-progress">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                    </div>

                    <!-- æ¶ˆæ¯è¾“å…¥ -->
                    <form class="message-input" id="messageForm">
                        <div class="input-wrapper">
                            <button type="button" class="file-button" id="fileButton" title="ä¸Šä¼ æ–‡ä»¶">
                                ğŸ“
                            </button>
                            <div class="input-field-container">
                                <textarea
                                    id="messageText"
                                    placeholder="è¾“å…¥æ¶ˆæ¯..."
                                    rows="1"
                                ></textarea>
                                <button type="submit" class="send-button" id="sendButton">
                                    <svg class="send-icon" viewBox="0 0 24 24" width="20" height="20">
                                        <path fill="currentColor" d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </main>
        

    </div>

    <!-- JavaScript æ¨¡å— -->
    <script src="./js/config.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/auth.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/ui.js"></script>
    <script src="./js/fileUpload.js"></script>
    <script src="./js/realtime.js"></script>
    <script src="./js/messageHandler.js"></script>
    <script src="./js/pwa.js"></script>
    <script src="./js/app.js"></script>

    <!-- PWAæµ‹è¯•è„šæœ¬ï¼ˆå¼€å‘æ¨¡å¼ï¼‰ -->
    <script>
        // ä»…åœ¨å¼€å‘ç¯å¢ƒåŠ è½½æµ‹è¯•è„šæœ¬
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
            const testScript = document.createElement('script');
            testScript.src = './js/pwa-test.js';
            document.head.appendChild(testScript);

            const debugScript = document.createElement('script');
            debugScript.src = './js/pwa-debug.js';
            document.head.appendChild(debugScript);
        }
    </script>
</body>
</html>
